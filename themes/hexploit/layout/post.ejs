<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>
    <%= config.title %><% if (page && page.title) { %> - <%= page.title %><% } %>
  </title>

  <link rel="icon" type="image/svg+xml" href="/img/favicon.svg">
  <link rel="icon" type="image/png" sizes="32x32" href="/img/favicon.svg">
  <link rel="apple-touch-icon" href="/img/favicon.svg">

  <link rel="stylesheet" href="/css/styles.css">
  <link rel="stylesheet" href="/css/tailwind.css">
  <link rel="stylesheet" href="/css/hacker.css">
  <link rel="stylesheet" href="/css/highlight.css">
  <link rel="stylesheet" href="/css/toc.css">

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

  <style>
    p {
      margin-top: 0 !important;
      margin-bottom: 1rem !important;
      font-size: 1.1rem;
    }

    figure {
      margin: 0 !important;
    }

    pre {
      padding: 0 !important;
      margin-top: 0 !important;
      margin-bottom: 1rem !important;
    }

    td {
      padding: 0 !important;
      margin-bottom: 1rem !important;
    }

    h1, h2, h3, h4, h5, h6 {
      margin-top: 0 !important;
      margin-bottom: 1rem !important;
    }

    @media (min-width: 1024px) {
      #middle-box {
        min-width: 56rem;
      }
    }
  </style>
</head>

<body class="bg-transparent text-hacker-color3 container mx-auto post-page" style="overflow-x:hidden">

  <div class="bg-image"></div>
  <canvas id="matrix" class="matrix-canvas"></canvas>

  <!-- Sticky Header -->
  <div class="sticky top-0 z-50">
    <%- partial('_partial/header') %>
  </div>

  <!-- Article Header -->
  <header class="post-header">
    <div class="post-header-content">
      <% if (page && page.date) { %>
        <time class="post-date"><%= date(page.date, "MMMM DD, YYYY") %></time>
      <% } %>

      <h1 class="post-title-editorial">
        <%= page && page.title ? page.title : "Untitled Post" %>
      </h1>

      <p class="post-subtitle">Security research & technical analysis</p>
    </div>
  </header>

  <!-- Article Content -->
  <% if (page.password_protected) { %>
  <!-- PASSWORD PROTECTION OVERLAY -->
  <div id="password-overlay" class="password-overlay">
    <div class="password-container">
      <div class="password-icon">
        <i class="fas fa-lock"></i>
      </div>
      <h2 class="password-title">üîí CLASSIFIED CONTENT</h2>
      <p class="password-subtitle">This operation brief requires authorization.</p>
      <% if (page.password_hint) { %>
        <p class="password-hint">Hint: <%= page.password_hint %></p>
      <% } %>
      <div class="password-input-wrapper">
        <input 
          type="password" 
          id="password-input" 
          class="password-input" 
          placeholder="Enter access key..."
          autocomplete="off"
        />
        <button id="password-submit" class="password-submit">
          <i class="fas fa-terminal"></i> AUTHENTICATE
        </button>
      </div>
      <p id="password-error" class="password-error" style="display: none;">
        ‚õî ACCESS DENIED ‚Äî Invalid credentials
      </p>
    </div>
  </div>
  <% } %>

  <div
    id="article-content"
    class="article-entry prose prose-invert mx-auto max-w-4xl leading-relaxed highlight"
    style="display: flex;<% if (page.password_protected) { %> filter: blur(20px); pointer-events: none; user-select: none;<% } %>"
  >
    <div id="middle-box">
      <div class="post-content">
        <%- page && page.content ? page.content : "" %>
      </div>
    </div>

    <% if (theme.toc && theme.toc.enable) { %>
      <div class="post-container">
        <aside class="toc-container">
          <button class="toc-toggle">Table of Contents</button>
          <nav class="toc" id="toc"></nav>
        </aside>
      </div>
    <% } %>
  </div>

  <!-- Back to Home -->
  <div class="text-center my-8">
    <a href="/" class="text-hacker-color1 underline hover:text-hacker-color2">
      ‚Üê Back to Home
    </a>
  </div>

  <script src="/js/menu.js"></script>
  <script src="/js/toc.js"></script>
  <script src="/js/matrix.js"></script>

  <% if (page.password_protected) { %>
  <!-- PASSWORD PROTECTION SCRIPT -->
  <script>
  (function() {
    // Plain text password
    const CORRECT_PASSWORD = 'iwantohackelonmaskat2025';
    
    const overlay = document.getElementById('password-overlay');
    const content = document.getElementById('article-content');
    const input = document.getElementById('password-input');
    const submit = document.getElementById('password-submit');
    const error = document.getElementById('password-error');
    
    function verifyPassword() {
      const password = input.value.trim();
      
      if (password === CORRECT_PASSWORD) {
        // Success - reveal content
        overlay.style.opacity = '0';
        overlay.style.pointerEvents = 'none';
        content.style.filter = 'none';
        content.style.pointerEvents = 'auto';
        content.style.userSelect = 'auto';
        
        setTimeout(() => {
          overlay.style.display = 'none';
        }, 300);
      } else {
        // Failure - show error
        error.style.display = 'block';
        input.classList.add('shake');
        input.value = '';
        
        setTimeout(() => {
          input.classList.remove('shake');
        }, 500);
      }
    }
    
    submit.addEventListener('click', verifyPassword);
    input.addEventListener('keypress', function(e) {
      if (e.key === 'Enter') {
        verifyPassword();
      }
    });
    
    // Focus input on load
    input.focus();
  })();
  </script>
  <% } %>

  <%- partial('_partial/footer') %>

</body>
</html>
