<header class="bg-transparent text-hacker-white py-2 font-dos font-extrabold relative z-50">
  <%
    /* SAFE VARIABLES (Hexo-compatible) */
    var currentPath = page.path ? '/' + page.path.replace(/index\.html$/, '') : '/';
    var menu = (theme && Array.isArray(theme.menu)) ? theme.menu : [];
  %>

  <!-- MOBILE HEADER (below 1024px) -->
  <div class="mobile-header items-center justify-between px-4 h-14">
    <button id="menu-toggle" class="text-hacker-color1 hover:text-white focus:outline-none p-2 z-50">
      <i class="fas fa-bars text-2xl"></i>
    </button>

    <h1 class="text-lg font-bold text-hacker-color1 whitespace-nowrap m-0 p-0 leading-none z-50">
      <a href="/" class="hover:text-white transition-colors select-none">
        <%= config.title %>
      </a>
    </h1>
    
    <button id="search-toggle-mobile" class="text-hacker-color1 hover:text-white focus:outline-none p-2 z-50">
      <i class="fas fa-search text-xl"></i>
    </button>
  </div>

  <!-- DESKTOP HEADER (1024px and above) -->
  <nav class="desktop-header hidden lg:flex items-center w-full">


    <!-- LEFT: Site Title -->
    <div class="flex-shrink-0">
      <h1 class="text-2xl font-bold text-hacker-color1 whitespace-nowrap m-0 p-0 leading-none">
        <a href="/" class="hover:text-white transition-colors select-none" style="display: flex; align-items: center;">
          <i class="fas fa-terminal" style="margin-right: 8px;"></i>
          <%= config.title %>
        </a>
      </h1>
    </div>

    <!-- RIGHT: Navigation + Search -->
    <div style="display: flex; align-items: center; margin-left: auto;">

      <% if (menu.length) { %>
        <% menu.forEach(function(item) { %>
          <%
            var itemPath = item.url.endsWith('/') ? item.url : item.url + '/';
            var isActive =
              currentPath === item.url ||
              currentPath === itemPath ||
              (item.url === '/' && currentPath === '/') ||
              (item.url === '/tags' && currentPath.indexOf('/tags') === 0);
          %>

          <a href="<%= item.url %>"
             class="nav-link text-hacker-color3 hover:text-hacker-color1 transition-colors font-dos <%= isActive ? 'nav-active' : '' %>"
             style="display: flex; align-items: center; padding: 8px 16px; font-size: 1rem;"
             <%= item.url.indexOf('http') === 0 || item.url.indexOf('mailto:') === 0 ? 'target="_blank" rel="noopener noreferrer"' : '' %>>
            <i class="fas fa-<%= item.name.toLowerCase() === 'home' ? 'home' : (item.name.toLowerCase() === 'about' ? 'user' : (item.name.toLowerCase() === 'tags' ? 'tags' : (item.name.toLowerCase() === 'contact' ? 'envelope' : 'circle'))) %>" style="margin-right: 6px;"></i>
            <span><%= item.name %></span>
          </a>
        <% }) %>
      <% } %>

      <button id="search-toggle" class="text-hacker-color1 hover:text-white focus:outline-none" style="padding: 8px; margin-left: 24px;">
        <i class="fas fa-search" style="font-size: 1.25rem;"></i>
      </button>
    </div>
  </nav>

  <!-- MOBILE SLIDE MENU -->
  <div id="mobile-menu-overlay"></div>

  <nav id="mobile-menu">
    <ul class="space-y-4 w-full px-4">

      <% if (menu.length) { %>
        <% menu.forEach(function(item) { %>
          <li>
            <a href="<%= item.url %>"
              class="flex items-center space-x-4 text-xl transition-colors font-dos p-2 rounded hover:bg-white/5"
              <%= item.url.indexOf('http') === 0 || item.url.indexOf('mailto:') === 0 ? 'target="_blank" rel="noopener noreferrer"' : '' %>>
              <span><%= item.name %></span>
            </a>
          </li>
        <% }) %>
      <% } %>

      <% if (theme.sidebar && Array.isArray(theme.sidebar.links)) { %>
        <li class="border-t border-gray-700 my-4"></li>
        <% theme.sidebar.links.forEach(function(link) { %>
          <li>
            <a href="<%= link.url %>"
               class="flex items-center space-x-4 text-lg text-hacker-color3 hover:text-hacker-color1 transition-colors font-dos p-2 rounded hover:bg-white/5">
              <span><%= link.name %></span>
            </a>
          </li>
        <% }) %>
      <% } %>

    </ul>
  </nav>
</header>
